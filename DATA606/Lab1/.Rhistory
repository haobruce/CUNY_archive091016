s <- round(init / spyAdjPrices[maxLookBack], 0)
c <- c - s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else {
# short shares
s <- -1 * round(init / spyAdjPrices[maxLookBack], 0)
c <- c + s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
# move forward with investment strategy
for (i in maxLookBack:length(ewma8_32)) { # setup for a 32 day lookback period
if (ewma8_32[i] < 0) { # if trend is downward
if (s >= 0) { # if you have shares
# sell existing shares
c <- c + s * spyAdjPrices[i]
s <- 0
# then short
s <- -1 * round(c / spyAdjPrices[i], 0)
c <- c + s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
} else if (ewma8_32[i] > 0) { # if trend is upward
if (s <= 0) { # if you are short
# cover short shares
c <- c - s * spyAdjPrices[i]
s <- 0
# then buy
s <- round(c / spyAdjPrices[i], 0)
c <- c - s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
}
print(df)
# start from first date and start investing
init <- 100000 # define initial investment amount
c <- init # define initial cash balance
s <- 0 # define initial shares owned
p <- 0 # define initial profit
maxLookBack <- 32
# create empty data frame to house performance results
df <- data.frame(Dates=numeric(), Price=numeric(), EWMA=numeric(), Cash=numeric(), Shares=numeric(), Balance=numeric())
#dfAdd <- data.frame(spyDates[maxLookBack], init, 0)
#df <- rbind(df, setNames(dfAdd, names(df)))
if (ewma8_32[maxLookBack] > 0) {
# buy shares
s <- round(init / spyAdjPrices[maxLookBack], 0)
c <- c - s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else {
# short shares
s <- -1 * round(init / spyAdjPrices[maxLookBack], 0)
c <- c + s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
# move forward with investment strategy
for (i in maxLookBack:length(ewma8_32)) { # setup for a 32 day lookback period
if (ewma8_32[i] < 0) { # if trend is downward
if (s >= 0) { # if you have shares
# sell existing shares
c <- c + s * spyAdjPrices[i]
s <- 0
# then short
s <- -1 * round(c / spyAdjPrices[i], 0)
c <- c + s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
} else if (ewma8_32[i] > 0) { # if trend is upward
if (s <= 0) { # if you are short
# cover short shares
c <- c - s * spyAdjPrices[i]
s <- 0
# then buy
s <- round(c / spyAdjPrices[i], 0)
c <- c - s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
}
}
print(df)
plot(df$Date, df$Shares)
df$Date
plot(df$Date, df$Shares, type="l")
plot(as.numeric(df$Date), df$Shares, type="l")
plot(as.Date(df$Date), df$Shares, type="l")
# start from first date and start investing
init <- 100000 # define initial investment amount
c <- init # define initial cash balance
s <- 0 # define initial shares owned
p <- 0 # define initial profit
maxLookBack <- 32
# create empty data frame to house performance results
df <- data.frame(Dates=numeric(), Price=numeric(), EWMA=numeric(), Cash=numeric(), Shares=numeric(), Balance=numeric())
#dfAdd <- data.frame(spyDates[maxLookBack], init, 0)
#df <- rbind(df, setNames(dfAdd, names(df)))
if (ewma8_32[maxLookBack] > 0) {
# buy shares
s <- round(init / spyAdjPrices[maxLookBack], 0)
c <- c - s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else {
# short shares
s <- -1 * round(init / spyAdjPrices[maxLookBack], 0)
c <- c + s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
# move forward with investment strategy
for (i in maxLookBack:length(ewma8_32)) { # setup for a 32 day lookback period
if (ewma8_32[i] < 0) { # if trend is downward
if (s >= 0) { # if you have shares
# sell existing shares
c <- c + s * spyAdjPrices[i]
s <- 0
# then short
s <- -1 * round(c / spyAdjPrices[i], 0)
c <- c + s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
} else if (ewma8_32[i] > 0) { # if trend is upward
if (s <= 0) { # if you are short
# cover short shares
c <- c - s * spyAdjPrices[i]
s <- 0
# then buy
s <- round(c / spyAdjPrices[i], 0)
c <- c - s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
}
}
print(df)
201/178-1
# start from first date and start investing
init <- 100000 # define initial investment amount
c <- init # define initial cash balance
s <- 0 # define initial shares owned
p <- 0 # define initial profit
maxLookBack <- 32
# create empty data frame to house performance results
df <- data.frame(Dates=numeric(), Price=numeric(), EWMA=numeric(), Cash=numeric(), Shares=numeric(), Balance=numeric())
#dfAdd <- data.frame(spyDates[maxLookBack], init, 0)
#df <- rbind(df, setNames(dfAdd, names(df)))
if (ewma8_32[maxLookBack] > 0) {
# buy shares
s <- round(init / spyAdjPrices[maxLookBack], 0)
c <- c - s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else {
# short shares
s <- -1 * round(init / spyAdjPrices[maxLookBack], 0)
c <- c + s * spyAdjPrices[maxLookBack]
dfAdd <- data.frame(spyDates[maxLookBack], spyAdjPrices[maxLookBack], ewma8_32[maxLookBack], c, s, abs(s) * spyAdjPrices[maxLookBack] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
# move forward with investment strategy
for (i in maxLookBack:length(ewma8_32)) { # setup for a 32 day lookback period
if (ewma8_32[i] < 0) { # if trend is downward
if (s > 0) { # if you have shares
# sell existing shares
c <- c + s * spyAdjPrices[i]
s <- 0
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else if (s == 0) { # if no shares
# then short
s <- -1 * round(c / spyAdjPrices[i], 0)
c <- c + s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
} else if (ewma8_32[i] > 0) { # if trend is upward
if (s < 0) { # if you are short
# cover short shares
c <- c - s * spyAdjPrices[i]
s <- 0
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
} else if (s == 0) { # if you have no shares
# then buy
s <- round(c / spyAdjPrices[i], 0)
c <- c - s * spyAdjPrices[i]
dfAdd <- data.frame(spyDates[i], spyAdjPrices[i], ewma8_32[i], c, s, abs(s) * spyAdjPrices[i] + c)
df <- rbind(df, setNames(dfAdd, names(df)))
}
}
}
print(df)
rm(list=all())
rm(list=ls())
gold = read.csv("/Users/brucehao/desktop/table.csv", headers=T)
gold = read.csv("/Users/brucehao/desktop/table.csv", header=T)
gold
gold = read.csv("/Users/brucehao/desktop/table.csv", header=T)
gold
model = lm(GG ~ GOLDSPOT, data=gold)
summary(model)
---
---
title: "BridgeR_03_Mushrooms"
author: "Bruce"
date: "July 28, 2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
## R Markdown Documentation of Downloading and Relabeling Mushroom Data from UCI
Install hash library.
```{r, echo=FALSE}
require(hash)
```
Read UCI data into dataframe and rename columns.
```{r}
df = read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/mushroom/agaricus-lepiota.data", header=FALSE)
colnames(df) = c('classes','cap_shape','cap_surface','cap_color','bruises?','odor','gill_attachment','gill_spacing','gill_size','gill_color','stalk_shape','stalk_root','stalk_surface_above_ring','stalk_surface_below_ring','stalk_color_above_ring','stalk_color_below_ring','veil_type','veil_color','ring_number','ring_type','spore_print_color', 'population','habitat')
```
Create hashes with abbreviations as keys and expanded names as values for each column. For brevity, only the first four columns are shown below.
```{r}
classes = hash(keys=c('e','p'), values=c('edible','poisonous'))
cap_shape = hash(keys=c('b','c','x','f','k','s'), values=c('bell','conical','convex','flat','knobbed','sunken'))
cap_surface = hash(keys=c('f','g','y','s'), values=c('fibrous','grooves','scaly','smooth'))
cap_color = hash(keys=c('n','b','c','g','r','p','u','e','w','y'), values=c('brown','buff','cinnamon','gray','green','pink','purple','red','white','yellow'))
```
Loop through dataframe columns and add expanded levels. For brevity, only first first columns are looped through below.
```{r}
for (i in 1:4) {
columnName = colnames(df)[i]
for (key in as.list(keys(get(columnName)))) {
levels(df[[columnName]]) = c(levels(df[[columnName]]), get(columnName)[[key]])
df[df[columnName]==key, columnName] = get(columnName)[[key]]
}
}
knitr::kable(head(df[1:4]))
```
library(hash)
install.packages('hash')
library(hash)
v = [383.6, 347.1, 371.9, 347.6, 325.8, 337]
v = ([)383.6, 347.1, 371.9, 347.6, 325.8, 337)
v = (383.6, 347.1, 371.9, 347.6, 325.8, 337)
v = list(383.6, 347.1, 371.9, 347.6, 325.8, 337)
v
v = c(383.6, 347.1, 371.9, 347.6, 325.8, 337)
v
mean(v)
sd(v)
?qnorm
mu = mean(v)
sig = sd(v)
qnorm(0.1, mu, sig)
qnorm(0.05, mu, sig)
qnorm(0.95, mu, sig)
?qt
n = length(v)
n
t = abs(qt(0.5, n-1))
t
qt(0.05, n-1)
t = abs(qt(0.05, n-1))
qnorm(0.05, 0, 1)
qnorm(0.95, 0, 1)
qnorm(0.975, 0, 1)
qnorm(0.025, 0, 1)
se = sig/sqrt(n)
se
mu + se*t
mu - se*t
t = abs(qt(0.2/2, 16-1))
t
mu = 46.4
sig = 2.45
se = sig / sqrt(16)
mu + se * t
mu - se * t
1.9/0.13
(1.9/0.13)^2
qnorm(0.025, 0, 1)
qnorm(0.005, 0, 1)
t = abs(qnorm(0.005, 0, 1))
8+t*1.9
8+t*1.9/(0.13/2)
(8+t*1.9/(0.13/2))^2
t
t*1.9
t*1.9/0.13
(t*1.9/0.13)^2
t = qnorm(0.025, 0, 1)
t
t = abs(qnorm(0.025, 0, 1))
(t*12.6/0.19)^2
(t*3.61^0.5/0.19)^2
1-1734/2089
se = sqrt(0.17*0.83/2089)
se
qnorm(0.01, 0.17, se)
qnorm(0.99, 0.17, se)
p = 156/474
p
se = p*(1-p)/474
qnorm(0.025, p, se)
qnorm(0.975, p, se)
se
se = sqrt(p*(1-p)/474)
qnorm(0.975, p, se)
qnorm(0.025, p, se)
install.packages(c('openintro','OIdata','devtools','ggplot2','psych','reshape2',
'knitr','markdown','shiny'))
devtools::install_github("jbryer/IS606")
library('IS606')
install.packages('dbConnect')
myDb = dbConnect(MySQL(), user='root', password='Aspire123', dbname='movies', host='127.0.0.1')
library(dbConnect)
myDb = dbConnect(MySQL(), user='root', password='Aspire123', dbname='movies', host='127.0.0.1')
rs1 = dbSendQuery(myDb, 'SELECT * FROM movie_names')
data = fetch(rs1, n=-1)
Query movie_names table.
```{r}
rs1 = dbSendQuery(myDb, 'SELECT * FROM movie_names')
movie_names = fetch(rs1, n=-1)
movie_names
```
Query movie_ratings table.
```{r}
rs2 = dbSendQuery(myDb, 'SELECT * FROM movie_ratings')
movie_ratings = fetch(rs2, n=-1)
movie_ratings
```
rs = dbSendQuery(myDb, 'SELECT names.*, ratings.user_id, ratings_rating
rs = dbSendQuery(myDb, 'SELECT names.*, ratings.user_id, ratings_rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
movies
rs = dbSendQuery(myDb, 'SELECT names.*, ratings.user_id, ratings_rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
rs = dbSendQuery(myDb, 'SELECT names.*, ratings.user_id, ratings.rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
movies
table(movies)
library(psych)
describeBy(movies, movie_names)
describeBy(movies, movie_ratings)
table(movies$movie_name, movies$rating)
table(movies$movie_name, avg(movies$rating))
table(movies$movie_name, movies$rating)
length(unique(movies$user_id))
(unique(movies$user_id))
length(unique(movies$user_id))
table(movies$movie_name, movies$rating/length(unique(movies$user_id)))
movies$avg_rating = movies$rating / length(unique(movies$user_id))
table(movies$movie_name, movies$avg_rating)
library(dbConnect)
myDb = dbConnect(MySQL(), user='root', password='Aspire123', dbname='movies', host='127.0.0.1')
rs = dbSendQuery(myDb, 'SELECT names.*, ratings.user_id, ratings.rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
movies
head(movies)
table(movies$movie_name)
table(movies$movie_name, movies$rating)
head(movies)
table(head(movies$movie_name), head(movies$rating))
View(movies)
rs = dbSendQuery(myDb, 'SELECT DISTINCT names.*, ratings.user_id, ratings.rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
table(movies$movie_name, movies$rating)
head(movies)
library(psych)
describe(movies)
describeBy(movies, movie_name)
describeBy(movies, group = movies$movie_name)
describeBy(movies$rating, group = movies$movie_name)
summary(movies)
summary(movies$movie_name)
install.packages('dplyr')
library(dplyr)
tbl_df(movies)
typeof(movies)
df = tbl_df(movies)
type(df)
typeof(df)
df
data.frame(movies)
df = data.frame(movies)
typeof(df)
movies
summarise(movies)
summarise(groupe_by(movies, movie_name), movie_rating)
summarise(group_by(movies, movie_name), movie_rating)
summarise(group_by(movies, movie_name), rating)
summarise(group_by(movies, movie_name), rating=mean(rating))
table(movies$movie_name, movies$rating)
summarise(group_by(movies, movie_name), avg_rating = mean(rating))
barplot(summarise(group_by(movies, movie_name), avg_rating = mean(rating)))
pvt_table = summarise(group_by(movies, movie_name), avg_rating = mean(rating))
barplot(pvt_table$movie_name, pvt_table$avg_rating)
barplot(pvt_table$avg_rating ~ pvt_table$movie_name)
barplot(pvt_table$avg_rating, pvt_table$movie_name)
?barplot
plot(pvt_table$avg_rating ~ pvt_table$movie_name)
?barplot
pvt_table
pvt_table$movie_name
pvt_table$avg_rating
barplot(pvt_table)
barplot(movies$rating)
barplot(movies$rating, movies$movie_name)
barplot(pvt_table$avg_rating)
?barplot
barplot(pvt_table$avg_rating, xlab = pvt_table$movie_name)
barplot(pvt_table$avg_rating, names.arg =  = pvt_table$movie_name)
barplot(pvt_table$avg_rating, names.arg = pvt_table$movie_name)
install.packages('ggvis')
library(ggvis)
ggvis(pvt_table, props(x=movie_name, y=rating)) + mark_rect(props(width:=10))
pvt_table
ggvis(pvt_table, props(x=pvt_table$movie_name, y=pvt_table$rating)) + mark_rect(props(width:=10))
length(pvt_table$movie_name)
ggvis(pvt_table, ~movie_name, ~avg_rating)
ggvis(pvt_table, props(x=movie_name, y=avg_rating)) + mark_rect(props(width:=10))
ggvis(pvt_table, props(x=~movie_name, y=~avg_rating)) + mark_rect(props(width:=10))
ggvis(pvt_table, props(x=~movie_name, y=~avg_rating))
table(movies$movie_name, movies$rating)
pvt = summarise(group_by(movies, movie_name), avg_rating = mean(rating))
pvt
ggvis(pvt, ~movie_name, ~avg_rating)
ggvis(pvt_table, ~movie_name, ~avg_rating) + mark_rect(props(width:=10))
pvt_table %>% ggivs(~movie_name, ~avg_rating)
pvt_table %>% ggvis(~movie_name, ~avg_rating)
pvt_table %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width=10)
pvt_table %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width=1)
pvt_table %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width=0.01)
pvt_table %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width=0.1)
pvt_table %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width=0.5)
library(IS606)
source("more/cdc.R")
setwd("~/Google Drive/CUNY/git/DATA606/Lab1")
source("more/cdc.R")
summary(cdc$height)
prop.table(table(cdc$height))
barplot(prop.table(table(cdc$height)))
cdc %>% ggvis(~age)
cdc %>% ggvis(~height)
cdc %>% ggvis(~height / nrow(cdc))
ggvis(prop.table(table(cdc$height)))
prop.table(table(cdc$height))
names(prop.table(table(cdc$height)))
values(prop.table(table(cdc$height)))
cdc %>% ggvis(~height, count(~height))
cdc %>% ggvis(~height, count)
cdc %>% ggvis(~height, ~count)
cdc %>% ggvis(~age)
cdc %>% ggvis(~age) %>% layer_bars(width = 0.1)
cdc %>% ggvis(~age)
cdc %>% ggvis(~age) %>% layer_histograms(binwidth=1)
bmi <- (cdc$weight / cdc$height^2) * 703
cdc %>% ggvis(~genhlth, bmi)
bmi
cdc$bmi = bmi
cdc %>% ggvis(~genhlth, ~bmi)
cdc %>% ggvis(~genhlth, ~bmi) %>% layer_boxplots()
v = c(57,66,69,71,72,73,74,77,78,78,79,79,81,81,82,83,83,88,89,94)
ggvis(v) %>% layer_boxplot()
ggvis(v) %>% layer_boxplots()
v %>% ggvis(v) %>% layer_boxplots()
v %>% ggvis() %>% layer_boxplots()
v
names(v)
ggvis(v)
ggvis(~v)
myDb = dbConnect(MySQL(), user='root', password='', dbname='movies', host='127.0.0.1')
rs = dbSendQuery(myDb, 'SELECT DISTINCT names.*, ratings.user_id, ratings.rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
myDb = dbConnect(MySQL(), user='root', password='', dbname='movies', host='127.0.0.1')
myDb = dbConnect(MySQL(), user='root', password='password', dbname='movies', host='127.0.0.1')
myDb = dbConnect(MySQL(), user='cunyUser', password='cunyPassword', dbname='movies', host='127.0.0.1')
myDb = dbConnect(MySQL(), user='cunyUser', password='cunyPassword', dbname='movies', host='127.0.0.1')
rs = dbSendQuery(myDb, 'SELECT DISTINCT names.*, ratings.user_id, ratings.rating
FROM movie_names names INNER JOIN movie_ratings ratings
ON names.movie_name = ratings.movie_name')
movies = fetch(rs, n=-1)
table(movies$movie_name, movies$rating)
pvt = summarise(group_by(movies, movie_name), avg_rating = mean(rating))
pvt
pvt %>% ggvis(~movie_name, ~avg_rating) %>% layer_bars(width = 0.7)
barplot(pvt$movie_name, pvt$avg_rating)
plot(pvt$movie_name, pvt$avg_rating)
plot(pvt$movie_name ~ pvt$avg_rating)
type(pvt)
typeof(pvt)
barplot(pvt$avg_rating)
barplot(pvt$avg_rating, names.arg = pvt$movie_name)
